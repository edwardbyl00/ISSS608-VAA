---
title: "Take-home_EX01 Draft"
author: "Edward"
---

## 1 Introduction

## 2 Getting Started

#### 2.1 Setting the Analytical Tools

-   skimr: Provides a frictionless approach to summary statistics which conforms to the principle of least surprise, displaying summary statistics the user can skim quickly to understand their data.

```{r}
pacman::p_load(readxl,skimr,tidyverse,ggthemes,
               hrbrthemes,patchwork,reshape2,ggridges, 
               ggdist,ggstatsplot,ggpubr,ggiraph,likert)
```

#### 2.2 Data Sources

## 3 Data Preparation

#### 3.1 Data Import

We first load in the dataset and name it student.

```{r}
student <- read_xlsx("Data/Database paper.xlsx",
                      sheet="Sheet1")
```

#### 3.2 Data Sanity Checks

We run a quick sanity checks to identify potential abnormal data as well as missing values using skimr. This is also good to understand the data distribution at a glance.

```{r}
skimr::skim(student)
```

Now we take a look at some of the data sample and also to ensure the data type are set correctly.

```{r}
glimpse(student)
```

We will proceed to rename some column with typo names and change the data type accordingly:

```{r}
#| code-fold: true
student <- student %>%
  
    rename(
    
    Time_SocialMedia = any_of('Time_SocicalMedia'),
    InfluenceOF_Friends = any_of('InfuenceF_Friends')
    
    )

```

The data variable is then re-labeled to bring in context:

```{r}
#| code-fold: true
student <- student %>%
  mutate(
    
    Year = factor(
      Year,
      levels = 3:5,
      labels = c("3rd Year", "4th Year", "Graduated"),
      ordered = TRUE),
    
    Gender = factor(Gender,
                    levels = c(1, 2),
                    labels = c("Male", "Female")),
    
    Policy_Stu = factor(Policy_Stu,
                        levels = c(1, 2),
                        labels = c("Yes", "No")),
    
    Minority_Stu = factor(Minority_Stu,
                          levels = c(1, 2),
                          labels = c("Yes", "No")),
    
    Poor_Stu = factor(Poor_Stu,
                      levels = c(1, 2),
                      labels = c("Yes", "No")
                      ),
        
    GPA = factor(GPA,
      levels = 1:5,
      labels = c("Poor","Average","Fair","Good","Excellent"),
      ordered = TRUE),
    
    GPA_value = as.numeric(GPA),

    
    across(c(Father_Edu, Mother_Edu),
    ~factor(.x,
            levels = 1:6,
            labels = c(
              "Primary",
              "Secondary",
              "High School",
              "College/University",
              "Graduate",
              "Not Public"),
            ordered = TRUE)),
            
    across(c(Time_Friends, Time_SocialMedia, Time_Studying,
      Adapt_Learning_Uni, Study_Methods, SupportOf_Uni,
      SupportOf_Lec, Facilitie_Uni, Quality_Lecturer,
      TrainingCurriculum, InfluenceOF_Friends),
    ~ factor(.x,
             levels = 1:5,
             labels = c("Not at all","Little","Moderate","Quite","Very"),
             ordered = TRUE)
  ))

```

```{r}
glimpse(student)
skimr::skim(student)
```

#### 3.3 Filters

#### 3.4 Feature Selection

## 4 Exploratory Data Analysis

#### Observation 1:

A 5% gap was observed in top academic performance: 37% of female students achieved a 'Good' or above GPA, compared to \~32% of male students.

```{r}
#| code-fold: true

gpa_pct <- student %>%
  count(Gender, GPA) %>%
  group_by(Gender) %>%
  mutate(pct = n / sum(n))


gpa <- ggplot(gpa_pct, aes(x = Gender, y = pct, fill = GPA)) +
  geom_col() +
  geom_text(
    aes(label = ifelse(pct >= 0.05, scales::percent(pct, accuracy = 1),"")),
    position = position_stack(vjust = 0.5),
    size = 3
  ) +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_brewer(palette = "Pastel1") +
  labs(
    title = "GPA Distribution by Gender",
    x = "Gender",
    y = "Percentage"
  ) +
  theme_minimal()

gpa

```

#### Observation 2:

Students with parent educated to a college level or higher are more likely to achieve a GPA of "Good" or above. While both parents' educational backgrounds correlate positively with student performance, the relationship is notably stronger with the mother's education level.

```{r}
#| code-fold: true
father_edu <-ggplot(student, aes(Father_Edu, fill = GPA)) +
  geom_bar(position = "fill") +
  coord_flip() +
  scale_y_continuous(labels = scales::percent) +
  labs(
    x = "Father's Education",
    y = "Percentage",
    fill = "GPA"
  )+
  scale_fill_brewer(palette = "Pastel1")+
  labs(
    title = "GPA Distribution by Father's Education",
    x = "Father's Education",
    y = "Percentage",
    fill = "GPA"
  ) 

mom_edu <-ggplot(student, aes(Mother_Edu, fill = GPA)) +
  geom_bar(position = "fill") +
  coord_flip() +
  scale_y_continuous(labels = scales::percent) +
  labs(
    x = "Mothers's Education",
    y = "Percentage",
    fill = "GPA"
  )+
  scale_fill_brewer(palette = "Pastel1")+
  labs(
    title = "GPA Distribution by Mothers's Education",
    x = "Mothers's Education",
    y = "Percentage",
    fill = "GPA"
  ) 

(mom_edu / father_edu)
```

#### Observation 3:

It was noted that there are some abnormilty with the follow feature where we are seeing a higher proportion of Student getting a Good or Excellent grade as compare to having better rating on :

-   Quality of Lecturer

-   Support from lecturers

-   Influence of friends

-   Study methods

```{r}
#| code-fold: true
method <- ggplot(student, aes(x = Study_Methods, fill = GPA)) +
  geom_bar(position = "fill") +
  scale_fill_brewer(palette = "Pastel1")+
  scale_y_continuous(labels = scales::percent) +
  theme_minimal()

Support_lec <- ggplot(student, aes(x = SupportOf_Lec, fill = GPA)) +
  geom_bar(position = "fill") +
  scale_fill_brewer(palette = "Pastel1") +
  scale_y_continuous(labels = scales::percent)+
  theme_minimal()

quality <- ggplot(student, aes(x = Quality_Lecturer, fill = GPA)) +
  geom_bar(position = "fill") +
  scale_fill_brewer(palette = "Pastel1") +
  scale_y_continuous(labels = scales::percent)+
  theme_minimal()

friend <- ggplot(student, aes(x = InfluenceOF_Friends, fill = GPA)) +
  geom_bar(position = "fill") +
  scale_fill_brewer(palette = "Pastel1")+
  scale_y_continuous(labels = scales::percent) +
  theme_minimal()

(quality / Support_lec) | (method/friend)
```

```{r}
#| code-fold: true
no_suport_lec <- student %>%
  filter(SupportOf_Lec =='Not at all')

ggplot(no_suport_lec, aes(Time_Studying, fill = GPA)) +
  geom_bar()+
  scale_fill_brewer(palette = "Pastel1")
```

```{r}
#| code-fold: true
ggplot(student, aes(x = GPA_value, y = Time_Studying, fill = Study_Methods)) +
  geom_density_ridges(
    alpha = 0.6,
    scale = 1.2,
    rel_min_height = 0.01
  ) +
  scale_x_continuous(
    breaks = 1:5,
    labels = c("Poor", "Average", "Fair", "Good", "Excellent")
  ) +
  labs(
    title = "Distribution of GPA by Time_Studying",
    x = "GPA",
    y = "Time_Studying"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Pastel1")

```

```{r}
#| code-fold: true
ggplot(student, aes(x = GPA_value, y = Study_Methods, fill = Quality_Lecturer)) +
  geom_density_ridges(
    alpha = 0.6,
    scale = 1.2,
    rel_min_height = 0.0
  ) +
  scale_x_continuous(
    breaks = 1:5,
    labels = c("Poor", "Average", "Fair", "Good", "Excellent")
  ) +
  labs(
    title = "Distribution of GPA by Study Methods",
    x = "GPA",
    y = "Study Methods"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Pastel1")



```

## 5 Conclusion

#### References

<https://forcats.tidyverse.org/>

<https://ggplot2.tidyverse.org/articles/ggplot2.html>
